bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "lm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "ols")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
mutate(Growth2=ln(Growth),
Stocks2=ln(Stocks))%>%
select(!stocks) %>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
mutate(Growth2=log(Growth),
Stocks2=log(Stocks))%>%
select(!stocks) %>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%  head()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=df)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
fill=time)) +
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
fill=time)) +
scale_color_gradient()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
fill=time)) +
scale_color_gradient2(low = "blue",
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
fill=time)) +
scale_fill_gradient2(low = "blue",
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low = "blue",
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low = "blue",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_aaas()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_brewer()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_brewer()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_discrete()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_continuous()+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low="blue",
mid="white",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_bw()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low="blue",
mid="white",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_classic()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low="blue",
mid="white",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm")+
facet_wrap(~df) +
theme_classic2()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low="blue",
mid="white",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm",
color="black")+
facet_wrap(~df) +
theme_classic2()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low="blue",
mid="white",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm",
color="black",
size=1)+
facet_wrap(~df) +
theme_classic2()
s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks)%>%
select(!stocks) %>%
filter(df=="High Inc")%>%
ggplot(aes(x=Growth,
y=Prices,
color=time)) +
scale_color_gradient2(low="blue",
mid="white",
midpoint = median(gdp$Time),
high="red")+
geom_point() +
labs(color="")+
geom_smooth(method = "glm",
color="black",
size=.5)+
facet_wrap(~df) +
theme_classic2()
#data
gdp<-data.frame(read.xlsx("world.xlsx",1))[1:49,]
# where are the .. ?
apply(gdp,2,function(x) which(x==".."))
# cleaned
gdp<-gdp[,-which(colnames(gdp)=="li")]
#combining growht and stocks in separate dfs
s<-list()
for (i in 1:ncol(gdp)){
s[[i]]<-data.frame(time=gdp$Time, Growth=gdp[,i],stocks=gdp$stocks)
}
#renaming
names(s)<-colnames(gdp)
names(s)<-c("Time",
"High Inc",
"Low & Mid Income",
"Lower Mid Income",
"Upper Mid Income",
"Stocks")
# plotting
gdpstocsk<-s[names(s) %nin% c("Time","Stocks")] %>%
bind_rows(.,.id="df") %>%
mutate(Prices=stocks/4)%>%
select(!stocks) %>%
reshape2::melt(.,id.vars=c("time","df")) %>%
ggplot(aes(x=time,
y=value/4,
color=variable)) +
geom_line() +
scale_y_continuous(
# Features of the first axis
name = "GDP",
# Add a second axis and specify its features
sec.axis = sec_axis( trans=~.*4, name="Stocks")
) +
labs(color="")+
facet_wrap(~df) +
theme_bw()
ggplotly(gdpstocsk)
saveWidget(ggplotly(gdpstocsk),
"gdp_stocks_ts.html",
selfcontained = F,
libdir = paste0(getwd()))
data.frame(read.xls("us.xls"))
data.frame(read.xlsx("us.xls"))
data.frame(read.xlsx("us.xls",1))
g1<-data.frame(read.xlsx("us.xls",1))
quantile(g1, probs=c(.05, .95), na.rm = FALSE)
g1<-data.frame(read.xlsx("us.xls",1))
quantile(g1$gdp, probs=c(.05, .95), na.rm = FALSE)
quantile(g1$gdp, probs=c(.01, .99), na.rm = FALSE)
quantile(g1$gdp, probs=c(.01, .99), na.rm = FALSE)
quantile(g1$gdp, probs=c(.01, .99), na.rm = FALSE)[1]
#outliers
lapply(gdp, 2, quantile(x, probs=c(.01, .99), na.rm = FALSE))
#outliers
lapply(gdp, 2, quantile(x, probs=c(.01, .99), na.rm = FALSE))
#outliers
lapply(gdp, 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
#outliers
lapply(gdp, 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
#outliers
apply(gdp, 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
#outliers
apply(g1, 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
# data
g1<-data.frame(as.numeric(read.xlsx("us.xls",1)))
# data
g1<-data.frame(read.xlsx("us.xls",1))
which(is.na(g1))
is.na(g1)
#outliers
apply(g1[,c(2,3)], 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
#outliers
outs<-apply(g1[,c(2,3)], 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
g1$gdp>outs[1,1] & g1$gdp<out[2,1]
g1$gdp>outs[1,1] & g1$gdp<outs[2,1]
g1$gdp[g1$gdp>outs[1,1] & g1$gdp<outs[2,1]]
ga<-g1$gdp[g1$gdp>outs[1,1] & g1$gdp<outs[2,1]]
sa<-g1$shares[g1$shares>outs[1,2] & g1$shares<outs[2,2]]
data.frame(ga,sa)
outs[2,2]
#outliers
outs<-apply(g1[,c(2,3)], 2, function(x) quantile(x, probs=c(.05, .95), na.rm = FALSE))
ga<-g1$gdp[g1$gdp>outs[1,1] & g1$gdp<outs[2,1]]
sa<-g1$shares[g1$shares>outs[1,2] & g1$shares<outs[2,2]]
data.frame(growth=ga,
prices=sa)
outs<-apply(g1[,c(2,3)], 2, function(x) quantile(x, probs=c(.05, .95), na.rm = FALSE))
ga<-g1$gdp[g1$gdp>outs[1,1] & g1$gdp<outs[2,1]]
sa<-g1$shares[g1$shares>outs[1,2] & g1$shares<outs[2,2]]
data.frame(growth=ga,
prices=sa)
data.frame(growth=ga,
prices=sa) %>%
ggplot(aes(x=growth,
y=prices))+
geom_point()
#outliers
outs<-apply(g1[,c(2,3)], 2, function(x) quantile(x, probs=c(.1, .9), na.rm = FALSE))
ga<-g1$gdp[g1$gdp>outs[1,1] & g1$gdp<outs[2,1]]
sa<-g1$shares[g1$shares>outs[1,2] & g1$shares<outs[2,2]]
data.frame(growth=ga,
prices=sa) %>%
ggplot(aes(x=growth,
y=prices))+
geom_point()
#outliers
outs<-apply(g1[,c(2,3)], 2, function(x) quantile(x, probs=c(.01, .99), na.rm = FALSE))
ga<-g1$gdp[g1$gdp>outs[1,1] & g1$gdp<outs[2,1]]
sa<-g1$shares[g1$shares>outs[1,2] & g1$shares<outs[2,2]]
data.frame(growth=ga,
prices=sa) %>%
ggplot(aes(x=growth,
y=prices))+
geom_point()
data.frame(growth=ga,
prices=sa) %>%
ggplot(aes(x=growth,
y=prices))+
geom_smooth()+
geom_point()
data.frame(growth=ga,
prices=sa) %>%
ggplot(aes(x=growth,
y=prices))+
geom_smooth(method = "glm")+
geom_point()
